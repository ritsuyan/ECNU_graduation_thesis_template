\chapter{绪\hskip 0.4cm 论}
\label{ch1}
\section{研究背景及意义}
随着移动互联网、物联网、工业智能化等技术的快速发展和技术性突破，本世纪以来汽车产业也发生了革命性的变化，汽车由传统的交通工具向出行、娱乐、智能等方向发展。汽车的智能和互联性正在推动车载网络系统的复
杂性和多样性的增加。

智能网联汽车目前正处于市场占有率飞速提升的阶段，智能网联汽车可以集成移动IVI系统，实现汽车应用的量级突破。智能网联汽车有望继智能手机之后，成为新一代的超级终端。
据市场研究公司Strategy Analytics发布的数据\cite{strategy_analytics_2020}显示，2019年全球智能网联汽车销售量约为210万辆，预计到2025年将增长至1.5亿辆，年均复合增长率为56\%,智能网联汽车产业规模呈现连续上涨趋势。
根据市场研究公司Grand View Research的报告显示\cite{grand_view_research_2020}，亚太地区是全球智能网联汽车市场的最大市场，销售占比达到了60\%以上。而北美和欧洲的市场规模也在不断扩大。

汽车的智能和互联性正在推动车载网络系统的复杂性和多样性的增加。信息通信技术给传统车辆带来了巨大的创新，也给现代车辆带来了重大的安全挑战。原本隔离的车载网络连
接到外部，增加了ICV（Intelligent Connected Vehicle，智能网联汽车）的攻击面，并带来了新的安全风险。汽车网络安全引起了公众的关注。
Checkoway 等人\cite{checkoway2011comprehensive}描述了智能网联汽车的外部攻击面，并可通过包括机械工具、CD播放器、蓝牙和蜂窝无线电，进行远程攻击。2015 年，查理·米勒和克里斯·瓦拉塞克演示了如何通过攻击IVI(In-Vehicle Infotainment, 车载娱乐信息系统)来入侵一辆吉普车的车载网络，并导致车辆的异常行
为，导致 140 万辆汽车被召回。与此同时，自动网络安全
开始引起公众的广泛关注\cite{miller2015remote}。Koscher 等人 \cite{koscher2010experimental} 通过嗅探
并向CAN(ControllerArea Network, 控制器局域网络)总线注入恶意代码，通过Dos
(Denial of Service, 拒绝服务)攻击阻断电子控制单元(ECU)通信，从而控制车辆的
多个功能模块。在Liu的研究\cite{liu2017vehicle}中，针对 CAN 的安全缺陷，提出了广
播、无认证、无加密、仲裁优先、接口易访问等五种对
CAN 的攻击方法。除了通过 CAN 攻击车辆，本地互联网络
(LIN) \cite{deng2017security}，FlexRay \cite{takahashi2017automotive} \cite{gu2016security} 总线系统和其他外部接
口，例如通用串行总线(USB)，蓝牙，Wi-Fi，蜂窝和车载OBD（On-Board Diagnostics，车载诊断系统），也可用于非法访问车载网络\cite{mousa2016lightweight}。
安全威胁远不止前面提到的那些。因此，有必要在
车辆的早期开发阶段进行安全威胁分析，以找出威胁漏
洞，实施安全措施，预防安全问题。

由上我们可得，对智能网联汽车安全威胁建模的研究意义将非常重要和深远，主要体现在以下几点：
\begin{itemize}
  \item 智能网联汽车的安全是车载驾驶人身安全和财产安全的关键。深入研究智能网联汽车的攻击与威胁问题，可以推动整车厂商对其进行改进和漏洞修复，从而保障驾驶人员生命和财产的安全。
  \item 为风险评估和缓解方案人员提供有用的数据和信息，并能及时发现危险来源，为缓解方案提供保障，全面系统化地展示智能网联汽车所面临的安全风险。
  \item 本文提出了智能网联领域新的安全建模与风险评估方案, 并成功实际的模拟远程入侵某款商用汽车，证明了目前在智能网联汽车中存在许多不可忽视的安全隐患，值得安全人员审慎和思考。  
\end{itemize}
\section{国内外研究现状}
关于智能网联汽车威胁建模及安全风险评估的问题，其国内外的相关
研究现状如下：

\subsection{智能网联汽车威胁面的调研}
智能网联汽车是一种集成了先进的信息和通信技术的汽车，能够实现与互联网的无缝连接，并具备自主驾驶、车辆感知、实时数据交互、智能控制等功能。集成化和智能化是智能网联汽车的两个核心特征。
随着设备老化和系统长久不更新安全补丁等因素，汽车面临的威胁日益剧增。此外，智能网联汽车的复杂性和高度集成化使其面临许多安全威胁。其中，接口安全是智能网联汽车面临的一个重要安全挑战。因为智能网联汽车需要与互联网、其他车辆和道路设施进行数据交换和通信，这就需要大量的接口和协议来实现各种功能。从有线、无线、到汽车
各种接口，出现更多的接口网络安全问题、硬件总线接口漏洞、第三方应用漏洞等。
而且，黑客攻击智能网联汽车的手段越来越深入和高明，令人防不胜防。
目前国内外学者对一些较为典型的漏洞使用进行了研究如下。

智能网联汽车的威胁面主要包括以下几个方面：

数据隐私和安全问题：智能网联汽车会收集和传输大量的车辆和驾驶员数据，包括车速、位置、加速度、刹车、转向等信息，这些数据可能会被黑客窃取或篡改，对车主的隐私和安全造成威胁。

远程攻击和控制问题：智能网联汽车可以通过互联网远程控制，包括启动、停止、加速、刹车等操作，如果被黑客攻击，将可能导致车辆失控、事故等严重后果。

车内网络攻击问题：智能网联汽车中包括了各种车载系统，如娱乐系统、导航系统、气候控制系统等，这些系统可能存在漏洞或被攻击，会对车辆的稳定性和安全性产生影响。

车辆网络安全问题：智能网联汽车中的各个模块和传感器通过网络进行通信，网络安全问题可能导致信息泄露、攻击等安全威胁。

Checkoway\cite{checkoway2011comprehensive} 等人从网络安全的角度描述了现代车辆
的安全威胁模型和外部攻击媒介，并研究了如何进入车辆
的内部网络。他们试图通过系统分析现代汽车的外部攻击面来解
决这个问题。通过广泛的攻击媒介(包括
机械工具、CD 播放器、蓝牙和蜂窝无线电)进行远
程攻击和漏洞利用。

Gosman\cite{7987438} 等人综述了智能网联汽车中的数据聚合和隐私保护问题，并介绍了当前的解决方法和技术。

Alomar\cite{alomar2017secure} 等人介绍了智能网联汽车中的通信安全问题，并提出了一些解决方案和技术，如认证和加密技术、安全路由协议等。

Deng \cite{deng2014security} 等人综述了车辆自组网中的安全和隐私问题，并提出了一些解决方案和技术，如密钥管理、入侵检测、安全路由等。

Peter \cite{peter2019evaluation} 等人对现代汽车远程无钥匙进入系统进行了实验评估，并发现了一些系统的漏洞和安全问题，提出了一些安全建议和改进方案。

Liu\cite{liu2017vehicle}等人总结了以下有效攻击方法:帧嗅探,帧伪造,
帧注入,重放攻击,拒绝服务攻击等。此外新型的智能网联汽车具有手机APP等能操控智能网联汽车本身的外部操控智能设备
因此从手机端APP等进行攻击也是目前比较流行的一个新颖攻击方法。

\subsection{智能网联汽车威胁建模领域的研究}
微软公司提出了STRIDE威胁模型 \cite{kohnfelder1999threats} 用于识别计算机安全威胁。用于帮助推理和发现对系统的威胁。它与可以并行构建的目标系统模型结合使用。这包括对流程、数据存储、数据流和信任边界的全面分解。

Mats Olsson\cite{lautenbach2021proposing}等人提出了HEAVENS威胁安全模型，针对车辆电子电气（E/E）系统的信息安全威胁分析和风险评估的方法、流程及工具支持，可结构化和系统化的方法发现潜在威胁。

Mohsin等人\cite{mohsin2017iotriskanalyzer} 介绍了一种基于概率模型检测的形式化风险
分析框架。他们的框架能够生成系统威胁模型，用于正式计算攻击的可能性和成本。

Agadakos\cite{agadakos2017jumping}等人介绍了一种使用 Alloy 为物联网中的网络物理攻击路径建
模的方法。他们的方法最终也会产生潜在的威胁。还提出
了支持物联网威胁分析方面的非形式化方法。

UcedaVelez等人提出了\cite{ucedavelez2015risk} 攻击模拟和威胁分析 (PASTA) 威胁建模方法的过程。它介绍了各种类型的应用程序威胁建模，并介绍了一种以风险为中心的方法，旨在应用与定义的威胁模型、漏洞、弱点和攻击模式可能产生的影响相称的安全对策。 

VAST\cite{shostack2015vast}框架旨在简化威胁建模和风险分析的过程。它通过使用可视化技术和敏捷方法来帮助安全团队更快地建模威胁和分析风险。VAST框架还提供了一组工具和技术来辅助威胁建模和风险分析。

Trike框架\cite{larrondo2013trike}是专门针对嵌入式系统进行威胁建模和风险分析的框架。它通过使用攻击树、数据流分析和形式化方法来建模威胁和分析风险。Trike框架还提供了一组工具和技术来辅助威胁建模和风险分析。
\section{本文工作和主要贡献}
\paragraph{本文贡献点主要有如下三个：}

\begin{enumerate}
    \item 系统分析了智能网联汽车的架构和主要特点，并从CAN、IVI系统、车内网络通信几个方
    面分析智能网联汽车所面临的安全威胁。
    对车载IVI系统进行了全面的系统安全分析，并利用传统的STRIDE模型对其进行了威胁建模，最后对几个典型的数据流进行了威胁评级。
    \item 分析了主流的威胁建模方法如HEAVENS, EVITAS, STRIDE, 攻击树等。
    研究智能网联汽车的威胁模型，结合STRIDE和攻击树模型提出一种创新的名为SATT的威胁建
模方法，对实际商用的汽车的网络架构进行了威胁建模并威胁分析模型，利用FAHP（模糊层次分析法）对攻击概率进行了计算，进行了风险评估，最后验证了模型的可用性。并和传统的STRIDE和攻击树建模做比较分析。
    \item 仿真实验和远程实例攻击
    通过知名安全软件Isograph AttackTree + 进行了仿真建模实验，验证了模型的有效性。针对汽车远距离通信，对汽车进行了远距离漏洞挖掘和渗透测试，通过蓝牙劫持信号、数据篡改抓包和车联APP破解等多种方式攻击车载系统，成功采集目标车辆敏感信息和实时GPS位置，并实现了远程入侵和车辆控制。
\end{enumerate}


\section{论文组织结构}
第一章是绪论， 主要介绍的是本文章的研究背景以及意义，对当下智能网联
汽车（ICV）的研究现状进行了介绍和总结，最后说明了本文章节的安排。

第二章是相关理论和基础技术介绍，分别对智能网联汽车的系
统架构、TSP 系统的组成、ICV 通信技术以及智能网联汽车安全威
胁做了全面的分析。对其攻击路径和方向做了分析和整理。对目前现有威胁建模常用方法进行了整理和分类、并介绍了模糊层次分析法为后续的威胁模型提出做了前置理论基础准备。

第三章我们首先介绍了对车载IVI系统进行了全面的系统安全分析，并利用传统的STRIDE模型对其进行了威胁建模，最后对几个典型的数据流进行了威胁评级。

第四章我们结合STRIDE和攻击树模型提出一种创新的名为SATT的威胁建模方法，对汽车网络架构进行威胁建模进行了威胁分析、并和传统的STRIDE建模进行了比较分析。

第五章，基于上述提出的威胁建模方法，先进行了仿真实验后对汽车通过蓝牙劫持信号、数据篡改抓包和车联APP逆向编译等方法进行实际攻击实验。

第六章，总结与展望。
最后，对全文进行了总结，并对存在的问题和存在的问题进行了分析，并提出了今后的研究方向。
